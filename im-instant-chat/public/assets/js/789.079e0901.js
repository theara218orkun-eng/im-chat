"use strict";(self["webpackChunkRaingad_IM"]=self["webpackChunkRaingad_IM"]||[]).push([[789],{3585:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"m-20"},[t("el-tabs",{attrs:{type:"border-card"}},[t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-setting"}),e._v(" 基础设置")]),t("el-form",{ref:"sysInfo",staticStyle:{width:"600px"},attrs:{model:e.sysInfo,rules:e.rules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"系统名称",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入系统名称"},model:{value:e.sysInfo.name,callback:function(t){e.$set(e.sysInfo,"name",t)},expression:"sysInfo.name"}})],1),t("el-form-item",{attrs:{label:"系统描述",prop:"description"}},[t("el-input",{attrs:{placeholder:"请输入系统描述"},model:{value:e.sysInfo.description,callback:function(t){e.$set(e.sysInfo,"description",t)},expression:"sysInfo.description"}})],1),t("el-form-item",{attrs:{label:"系统LOGO",prop:"logo"}},[t("el-upload",{staticClass:"avatar-uploader",attrs:{headers:e.getToken,action:e.getUrl,"show-file-list":!1,"on-success":e.uploadSuccess,"on-change":e.change,"before-upload":e.beforeAvatarUpload}},[e.sysInfo.logo?t("img",{staticClass:"avatar",attrs:{src:e.sysInfo.logo}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),t("el-input",{staticStyle:{display:"none"},model:{value:e.sysInfo.logo,callback:function(t){e.$set(e.sysInfo,"logo",t)},expression:"sysInfo.logo"}})],1),t("el-form-item",{attrs:{label:"注册方式",prop:"regtype"}},[t("el-radio-group",{model:{value:e.sysInfo.regtype,callback:function(t){e.$set(e.sysInfo,"regtype",t)},expression:"sysInfo.regtype"}},[t("el-radio",{attrs:{label:"1",border:""}},[e._v("开启注册")]),t("el-radio",{attrs:{label:"2",border:""}},[e._v("邀请注册")])],1),t("div",{directives:[{name:"show",rawName:"v-show",value:2==e.sysInfo.regtype,expression:"sysInfo.regtype==2"}],staticClass:"mt-15"},[t("el-input",{staticClass:"input-with-select",model:{value:e.inviteUrl,callback:function(t){e.inviteUrl=t},expression:"inviteUrl"}},[t("el-button",{attrs:{slot:"append"},on:{click:e.copyUrl},slot:"append"},[e._v("复制链接")])],1),t("div",{staticClass:"mt-15"},[t("span",{staticClass:"c-999 f-12 mr-10"},[e._v("邀请链接有效期：48小时")]),e._v(" "),t("el-button",{on:{click:e.resetInviteUrl}},[e._v("重新生成")])],1),t("vue-qr",{ref:"qrCode",attrs:{text:e.inviteUrl,width:"200",height:"200",logoSrc:e.sysInfo.logo}})],1)],1),t("el-form-item",{attrs:{label:"注册时间间隔",prop:"registerInterval"}},[t("el-input-number",{staticClass:"ml-10",attrs:{min:0,step:60},model:{value:e.sysInfo.registerInterval,callback:function(t){e.$set(e.sysInfo,"registerInterval",t)},expression:"sysInfo.registerInterval"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("秒，0表示不限制，防止用户无限注册，仅限单IP")])],1),t("el-form-item",{attrs:{label:"注册认证",prop:"regauth"}},[t("el-radio-group",{model:{value:e.sysInfo.regauth,callback:function(t){e.$set(e.sysInfo,"regauth",t)},expression:"sysInfo.regauth"}},[t("el-radio",{attrs:{label:"0",border:""}},[e._v("关闭")]),t("el-radio",{attrs:{label:"1",border:""}},[e._v("手机号")]),t("el-radio",{attrs:{label:"2",border:""}},[e._v("邮箱")]),t("el-radio",{attrs:{label:"3",border:""}},[e._v("手机号+邮箱")])],1)],1),t("el-form-item",{attrs:{label:"开启IP定位",prop:"ipregion"}},[t("el-radio-group",{model:{value:e.sysInfo.ipregion,callback:function(t){e.$set(e.sysInfo,"ipregion",t)},expression:"sysInfo.ipregion"}},[t("el-radio",{attrs:{label:"0",border:""}},[e._v("关闭")]),t("el-radio",{attrs:{label:"1",border:""}},[e._v("开启")])],1)],1),t("el-form-item",{attrs:{label:"多端同时登录",prop:"multipleLogin"}},[t("el-radio-group",{model:{value:e.sysInfo.multipleLogin,callback:function(t){e.$set(e.sysInfo,"multipleLogin",t)},expression:"sysInfo.multipleLogin"}},[t("el-radio",{attrs:{label:"0",border:""}},[e._v("关闭")]),t("el-radio",{attrs:{label:"1",border:""}},[e._v("开启")])],1)],1),t("el-form-item",{attrs:{label:"运行模式",prop:"runMode"}},[t("el-radio-group",{model:{value:e.sysInfo.runMode,callback:function(t){e.$set(e.sysInfo,"runMode",t)},expression:"sysInfo.runMode"}},[t("el-radio",{attrs:{label:"1",border:""}},[e._v("企业模式")]),t("el-radio",{attrs:{label:"2",border:""}},[e._v("社交模式")])],1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.sysInfo.runMode,expression:"sysInfo.runMode==1"}],attrs:{label:"自由改名",prop:"diyName"}},[t("el-radio-group",{model:{value:e.sysInfo.diyName,callback:function(t){e.$set(e.sysInfo,"diyName",t)},expression:"sysInfo.diyName"}},[t("el-radio",{attrs:{label:"0",border:""}},[e._v("关闭")]),t("el-radio",{attrs:{label:"1",border:""}},[e._v("开启")])],1),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("企业模式下默认不允许自由改名，开启后生效")])],1),t("el-form-item",{attrs:{label:"系统状态",prop:"state"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.sysInfo.state,callback:function(t){e.$set(e.sysInfo,"state",t)},expression:"sysInfo.state"}}),t("div",{directives:[{name:"show",rawName:"v-show",value:0==e.sysInfo.state,expression:"sysInfo.state==0"}]},[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("关闭提示语")]),t("el-input",{attrs:{placeholder:"请输入系统关闭后的提示语",type:"textarea"},model:{value:e.sysInfo.closeTips,callback:function(t){e.$set(e.sysInfo,"closeTips",t)},expression:"sysInfo.closeTips"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("sysInfo")}}},[e._v("保存")])],1)],1)],1),t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-chat-line-square"}),e._v(" 聊天设置")]),t("el-form",{ref:"chatInfo",staticClass:"demo-chatInfo",attrs:{model:e.chatInfo,rules:e.chatRules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"允许用户私聊",prop:"simpleChat"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.chatInfo.simpleChat,callback:function(t){e.$set(e.chatInfo,"simpleChat",t)},expression:"chatInfo.simpleChat"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("关闭后，用户将无法私聊")])],1),t("el-form-item",{attrs:{label:"允许用户建群",prop:"groupChat"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.chatInfo.groupChat,callback:function(t){e.$set(e.chatInfo,"groupChat",t)},expression:"chatInfo.groupChat"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("关闭后，用户将无法创建群聊")])],1),t("el-form-item",{attrs:{label:"群聊最多人数",prop:"groupUserMax"}},[t("el-input-number",{staticClass:"ml-10",attrs:{min:0,max:1e3},model:{value:e.chatInfo.groupUserMax,callback:function(t){e.$set(e.chatInfo,"groupUserMax",t)},expression:"chatInfo.groupUserMax"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("人，0表示不限制，不建议超过300人")])],1),t("el-form-item",{attrs:{label:"开启在线状态",prop:"online"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.chatInfo.online,callback:function(t){e.$set(e.chatInfo,"online",t)},expression:"chatInfo.online"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("开启后，用户可以看到联系人的在线状态")])],1),t("el-form-item",{attrs:{label:"消息发送频率",prop:"sendInterval"}},[t("el-input-number",{staticClass:"ml-10",attrs:{min:0,max:1e3},model:{value:e.chatInfo.sendInterval,callback:function(t){e.$set(e.chatInfo,"sendInterval",t)},expression:"chatInfo.sendInterval"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("秒，0表示不限制，防止用户刷消息")])],1),t("el-form-item",{attrs:{label:"消息撤回时间",prop:"redoTime"}},[t("el-input-number",{staticClass:"ml-10",attrs:{min:0,max:86400},model:{value:e.chatInfo.redoTime,callback:function(t){e.$set(e.chatInfo,"redoTime",t)},expression:"chatInfo.redoTime"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("秒，0表示不支持撤回")])],1),t("el-form-item",{attrs:{label:"消息双向删除",prop:"dbDelMsg"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.chatInfo.dbDelMsg,callback:function(t){e.$set(e.chatInfo,"dbDelMsg",t)},expression:"chatInfo.dbDelMsg"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("开启后，用户删除消息会删除双方，仅限删除自己发送的")])],1),t("el-form-item",{attrs:{label:"消息自动清理",prop:"msgClear"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.chatInfo.msgClear,callback:function(t){e.$set(e.chatInfo,"msgClear",t)},expression:"chatInfo.msgClear"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("开启后，将会自动删除系统内的聊天记录")]),t("div",{directives:[{name:"show",rawName:"v-show",value:1==e.chatInfo.msgClear,expression:"chatInfo.msgClear==1"}]},[t("span",{staticClass:"c-999 f-12"},[e._v("消息最大保留天数")]),t("el-input-number",{staticClass:"ml-10",attrs:{min:0,max:1e3},model:{value:e.chatInfo.msgClearDay,callback:function(t){e.$set(e.chatInfo,"msgClearDay",t)},expression:"chatInfo.msgClearDay"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("系统在每日凌晨2点自动清理该天数以前的消息")])],1)],1),t("el-form-item",{attrs:{label:"自动添加客服",prop:"autoAddUser"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.chatInfo.autoAddUser.status,callback:function(t){e.$set(e.chatInfo.autoAddUser,"status",t)},expression:"chatInfo.autoAddUser.status"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("开启后，用户注册之后自动设置为专属客服。")]),t("div",{directives:[{name:"show",rawName:"v-show",value:"1"==e.chatInfo.autoAddUser.status,expression:"chatInfo.autoAddUser.status=='1'"}],staticClass:"mt-10"},[t("div",{staticClass:"lz-flex"},[t("span",{staticClass:"c-999 f-12"},[e._v("客服人员：")]),t("user-select",{attrs:{width:"300px"},on:{change:e.changeUser},model:{value:e.chatInfo.autoAddUser.user_items,callback:function(t){e.$set(e.chatInfo.autoAddUser,"user_items",t)},expression:"chatInfo.autoAddUser.user_items"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("如果选择多个则循环设置")])],1),t("div",{staticClass:"mt-10"},[t("span",{staticClass:"c-999 f-12"},[e._v("欢迎语")]),t("el-input",{staticClass:"ml-10",staticStyle:{width:"300px"},attrs:{type:"text"},model:{value:e.chatInfo.autoAddUser.welcome,callback:function(t){e.$set(e.chatInfo.autoAddUser,"welcome",t)},expression:"chatInfo.autoAddUser.welcome"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("通过客服自动发送给新注册的人员")])],1)])],1),t("el-form-item",{attrs:{label:"自动加入群聊",prop:"autoAddGroup"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.chatInfo.autoAddGroup.status,callback:function(t){e.$set(e.chatInfo.autoAddGroup,"status",t)},expression:"chatInfo.autoAddGroup.status"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("开启后，用户注册之后自动加入群聊。")]),t("div",{directives:[{name:"show",rawName:"v-show",value:"1"==e.chatInfo.autoAddGroup.status,expression:"chatInfo.autoAddGroup.status=='1'"}]},[t("div",{staticClass:"mt-10"},[t("span",{staticClass:"c-999 f-12"},[e._v("群聊名称")]),t("el-input",{staticClass:"ml-10",staticStyle:{width:"180px"},attrs:{type:"text",placeholder:"请输入群聊名称"},model:{value:e.chatInfo.autoAddGroup.name,callback:function(t){e.$set(e.chatInfo.autoAddGroup,"name",t)},expression:"chatInfo.autoAddGroup.name"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("自动生成群聊名称")])],1),t("div",{staticClass:"lz-flex mt-10"},[t("span",{staticClass:"c-999 f-12"},[e._v("默认群主：")]),t("user-select",{attrs:{width:"180px",radio:!0},on:{change:e.changeOwner},model:{value:e.chatInfo.autoAddGroup.owner_uid,callback:function(t){e.$set(e.chatInfo.autoAddGroup,"owner_uid",t)},expression:"chatInfo.autoAddGroup.owner_uid"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("选择后将自动设置为默认群主")])],1),t("div",{staticClass:"mt-10"},[t("span",{staticClass:"c-999 f-12"},[e._v("群聊成员上限：")]),t("el-input-number",{attrs:{min:5,max:1e3},model:{value:e.chatInfo.autoAddGroup.userMax,callback:function(t){e.$set(e.chatInfo.autoAddGroup,"userMax",t)},expression:"chatInfo.autoAddGroup.userMax"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("达到上限后自动创建新的群聊")])],1)])],1),t("el-form-item",{attrs:{label:"音视频通话",prop:"webrtc"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.chatInfo.webrtc,callback:function(t){e.$set(e.chatInfo,"webrtc",t)},expression:"chatInfo.webrtc"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("开启后，可以进行音视频通话，仅支持1对1音视频")]),t("div",{directives:[{name:"show",rawName:"v-show",value:1==e.chatInfo.webrtc,expression:"chatInfo.webrtc==1"}]},[t("div",{staticClass:"mt-15"},[t("span",{staticClass:"c-999 f-12"},[e._v("turn服务器")]),t("el-input",{staticClass:"ml-10",staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"请输入stun服务器"},model:{value:e.chatInfo.stun,callback:function(t){e.$set(e.chatInfo,"stun",t)},expression:"chatInfo.stun"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("音视频通话需要有Stun服务器才可以进行，请加`turn:`协议头")])],1),t("div",{staticClass:"mt-15"},[t("span",{staticClass:"c-999 f-12"},[e._v("turn用户名")]),t("el-input",{staticClass:"ml-10",staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"请输入stun用户名"},model:{value:e.chatInfo.stunUser,callback:function(t){e.$set(e.chatInfo,"stunUser",t)},expression:"chatInfo.stunUser"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("如果是公开的则可以不填写")])],1),t("div",{staticClass:"mt-15"},[t("span",{staticClass:"c-999 f-12"},[e._v("turn密码")]),t("el-input",{staticClass:"ml-10",staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"请输入stun服务器密码"},model:{value:e.chatInfo.stunPass,callback:function(t){e.$set(e.chatInfo,"stunPass",t)},expression:"chatInfo.stunPass"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("如果是公开的则可以不填写")])],1)])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("chatInfo")}}},[e._v("保存")])],1)],1)],1),t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-message"}),e._v(" 邮件短信设置")]),t("el-alert",{staticClass:"mb-20",attrs:{title:"系统支持短信验证码，请到项目：[根目录/config/sms.php] 中配置短信开放平台的参数，支持阿里云、腾讯云、七牛云、又拍云、Ucloud和华为云。",type:"warning"}}),t("el-form",{ref:"smtp",staticStyle:{width:"500px"},attrs:{model:e.smtp,rules:e.smtpRules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"邮件服务器",prop:"host"}},[t("el-input",{attrs:{placeholder:"请输入邮件服务器，如：smtp.mail.qq.com"},model:{value:e.smtp.host,callback:function(t){e.$set(e.smtp,"host",t)},expression:"smtp.host"}})],1),t("el-form-item",{attrs:{label:"端口号",prop:"port"}},[t("el-input-number",{attrs:{min:0,max:99999},model:{value:e.smtp.port,callback:function(t){e.$set(e.smtp,"port",t)},expression:"smtp.port"}})],1),t("el-form-item",{attrs:{label:"加密方式",prop:"security"}},[t("el-radio-group",{model:{value:e.smtp.security,callback:function(t){e.$set(e.smtp,"security",t)},expression:"smtp.security"}},[t("el-radio",{attrs:{label:"ssl",border:""}},[e._v("SSL")]),t("el-radio",{attrs:{label:"tls",border:""}},[e._v("TLS")])],1)],1),t("el-form-item",{attrs:{label:"发件人邮箱",prop:"addr"}},[t("el-input",{attrs:{placeholder:"请输入发件人的邮箱"},model:{value:e.smtp.addr,callback:function(t){e.$set(e.smtp,"addr",t)},expression:"smtp.addr"}})],1),t("el-form-item",{attrs:{label:"发件人密码",prop:"pass"}},[t("el-input",{attrs:{"show-password":"",placeholder:"请输入发件人的密码"},model:{value:e.smtp.pass,callback:function(t){e.$set(e.smtp,"pass",t)},expression:"smtp.pass"}})],1),t("el-form-item",{attrs:{label:"发件人签名",prop:"sign"}},[t("el-input",{attrs:{placeholder:"请输入发件人签名"},model:{value:e.smtp.sign,callback:function(t){e.$set(e.smtp,"sign",t)},expression:"smtp.sign"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("smtp")}}},[e._v("保存")])],1),t("el-form-item",{attrs:{label:"测试邮件"}},[t("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入邮件地址"},model:{value:e.textEmail,callback:function(t){e.textEmail=t},expression:"textEmail"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-s-promotion",loading:e.loadding},on:{click:e.sendEmail},slot:"append"},[e._v("发送")])],1)],1)],1)],1),t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-upload"}),e._v(" 文件上传设置")]),t("div",{staticClass:"mb-20"},[t("el-alert",{attrs:{title:"一旦设置了储存位置，就不能再进行更改，否则之前的文件或者图片加载就会出错！此修改会变更环境变量中的参数，请慎重操作！",type:"warning","show-icon":"",closable:!1}})],1),t("el-form",{ref:"fileUpload",staticStyle:{width:"600px"},attrs:{model:e.fileUpload,rules:e.fileRules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"储存位置",prop:"disk"}},[t("el-radio-group",{model:{value:e.fileUpload.disk,callback:function(t){e.$set(e.fileUpload,"disk",t)},expression:"fileUpload.disk"}},[t("el-radio",{attrs:{label:"local",border:""}},[e._v("本地")]),t("el-radio",{attrs:{label:"aliyun",border:""}},[e._v("阿里云")]),t("el-radio",{attrs:{label:"qiniu",border:""}},[e._v("七牛云")]),t("el-radio",{attrs:{label:"qcloud",border:""}},[e._v("腾讯云")])],1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"aliyun"==e.fileUpload.disk,expression:"fileUpload.disk=='aliyun'"}],attrs:{label:"阿里云配置"}},[t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("accessId")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入阿里云OSS平台的accessId"},model:{value:e.fileUpload.aliyun.accessId,callback:function(t){e.$set(e.fileUpload.aliyun,"accessId",t)},expression:"fileUpload.aliyun.accessId"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("accessSecret")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入阿里云OSS平台的accessSecret"},model:{value:e.fileUpload.aliyun.accessSecret,callback:function(t){e.$set(e.fileUpload.aliyun,"accessSecret",t)},expression:"fileUpload.aliyun.accessSecret"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("endpoint")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入阿里云OSS平台的endpoint"},model:{value:e.fileUpload.aliyun.endpoint,callback:function(t){e.$set(e.fileUpload.aliyun,"endpoint",t)},expression:"fileUpload.aliyun.endpoint"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("bucket")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入阿里云OSS平台的bucket"},model:{value:e.fileUpload.aliyun.bucket,callback:function(t){e.$set(e.fileUpload.aliyun,"bucket",t)},expression:"fileUpload.aliyun.bucket"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("url")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入阿里云OSS平台的域名"},model:{value:e.fileUpload.aliyun.url,callback:function(t){e.$set(e.fileUpload.aliyun,"url",t)},expression:"fileUpload.aliyun.url"}})],1)]),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"qiniu"==e.fileUpload.disk,expression:"fileUpload.disk=='qiniu'"}],attrs:{label:"七牛云配置"}},[t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("accessKey")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入七牛云平台的accessKey"},model:{value:e.fileUpload.qiniu.accessKey,callback:function(t){e.$set(e.fileUpload.qiniu,"accessKey",t)},expression:"fileUpload.qiniu.accessKey"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("secretKey")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入七牛云平台的secretKey"},model:{value:e.fileUpload.qiniu.secretKey,callback:function(t){e.$set(e.fileUpload.qiniu,"secretKey",t)},expression:"fileUpload.qiniu.secretKey"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("bucket")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入七牛云平台的bucket"},model:{value:e.fileUpload.qiniu.bucket,callback:function(t){e.$set(e.fileUpload.qiniu,"bucket",t)},expression:"fileUpload.qiniu.bucket"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("url")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入七牛云平台的域名"},model:{value:e.fileUpload.qiniu.url,callback:function(t){e.$set(e.fileUpload.qiniu,"url",t)},expression:"fileUpload.qiniu.url"}})],1)]),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"qcloud"==e.fileUpload.disk,expression:"fileUpload.disk=='qcloud'"}],attrs:{label:"腾讯云配置"}},[t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("appId")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入腾讯云平台的appId"},model:{value:e.fileUpload.qcloud.appId,callback:function(t){e.$set(e.fileUpload.qcloud,"appId",t)},expression:"fileUpload.qcloud.appId"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("secretId")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入腾讯云平台的secretId"},model:{value:e.fileUpload.qcloud.secretId,callback:function(t){e.$set(e.fileUpload.qcloud,"secretId",t)},expression:"fileUpload.qcloud.secretId"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("secretKey")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入腾讯云平台的secretKey"},model:{value:e.fileUpload.qcloud.secretKey,callback:function(t){e.$set(e.fileUpload.qcloud,"secretKey",t)},expression:"fileUpload.qcloud.secretKey"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("region")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入腾讯云平台的region"},model:{value:e.fileUpload.qcloud.region,callback:function(t){e.$set(e.fileUpload.qcloud,"region",t)},expression:"fileUpload.qcloud.region"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("bucket")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入腾讯云平台的bucket"},model:{value:e.fileUpload.qcloud.bucket,callback:function(t){e.$set(e.fileUpload.qcloud,"bucket",t)},expression:"fileUpload.qcloud.bucket"}})],1),t("div",[t("span",{staticClass:"mr-10 c-999 f-12"},[e._v("cdn")]),e._v(" "),t("el-input",{attrs:{placeholder:"请输入腾讯云平台的域名"},model:{value:e.fileUpload.qcloud.cdn,callback:function(t){e.$set(e.fileUpload.qcloud,"cdn",t)},expression:"fileUpload.qcloud.cdn"}})],1)]),t("el-form-item",{attrs:{label:"文件预览地址",prop:"preview"}},[t("el-input",{attrs:{placeholder:"请输入文件预览的地址，若无则使用默认预览工具"},model:{value:e.fileUpload.preview,callback:function(t){e.$set(e.fileUpload,"preview",t)},expression:"fileUpload.preview"}})],1),t("el-form-item",{attrs:{label:"文件大小限制",prop:"size"}},[t("el-input-number",{attrs:{min:0,max:500,label:""},model:{value:e.fileUpload.size,callback:function(t){e.$set(e.fileUpload,"size",t)},expression:"fileUpload.size"}}),e._v(" "),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("MB")])],1),t("el-form-item",{attrs:{label:"文件格式限制",prop:"fileExt"}},[t("el-select",{staticStyle:{width:"480px"},attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"",placeholder:"请输入允许上传的文件格式"},model:{value:e.fileUpload.fileExt,callback:function(t){e.$set(e.fileUpload,"fileExt",t)},expression:"fileUpload.fileExt"}},e._l(e.options,(function(e,s){return t("el-option",{key:s,attrs:{label:e,value:e}})})),1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("fileUpload")}}},[e._v("保存")])],1)],1)],1),t("el-tab-pane",[t("span",{attrs:{slot:"label"},slot:"label"},[t("i",{staticClass:"el-icon-discover"}),e._v(" 探索设置")]),t("el-alert",{staticClass:"mb-15",attrs:{"show-icon":"",closable:!1,title:"应用内的链接一定要是 '/' 开头，外部URL需要带协议头，以 '/' 结尾；图标、名称、链接为必填项，如果没填写则无法保存。该功能只对移动端有效！",type:"warning"}}),t("el-form",{ref:"compass",attrs:{model:e.compass,rules:e.compassRules,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"开启探索"}},[t("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},model:{value:e.compass.status,callback:function(t){e.$set(e.compass,"status",t)},expression:"compass.status"}}),t("span",{staticClass:"ml-10 c-999 f-12"},[e._v("关闭后，不显示探索页面")])],1),t("el-form-item",{attrs:{label:"展示模式"}},[t("el-radio-group",{model:{value:e.compass.mode,callback:function(t){e.$set(e.compass,"mode",t)},expression:"compass.mode"}},[t("el-radio",{attrs:{label:"1",border:""}},[e._v("列表模式")]),t("el-radio",{attrs:{label:"2",border:""}},[e._v("宫格模式")])],1)],1),t("el-form-item",{attrs:{label:"应用列表"}},[t("div",{staticClass:"lz-flex lz-align-items-center lz-align-content-center"},[t("div",{staticClass:"ml-10",staticStyle:{width:"60px"}},[e._v("图标")]),t("div",{staticStyle:{width:"130px"}},[e._v("名称")]),t("div",{staticStyle:{width:"130px"}},[e._v("类型")]),t("div",{staticStyle:{width:"310px"}},[e._v("链接")]),t("div",{staticStyle:{width:"80px"}},[e._v("排序")]),t("div",{staticStyle:{width:"60px"}},[e._v("状态")]),t("div",{staticStyle:{width:"60px"}},[e._v("操作")])])]),e._l(e.compass.list,(function(s,a){return t("el-form-item",{key:a,attrs:{prop:"list"}},[t("div",{staticClass:"lz-flex lz-align-items-center lz-align-content-center"},[t("el-upload",{staticClass:"avatar-uploader mr-10",staticStyle:{width:"50px",height:"50px"},attrs:{headers:e.getToken,action:e.getUrl,"show-file-list":!1,"on-success":e.iconUploadSuccess.bind(null,a)}},[s.icon?t("img",{staticClass:"avatar",staticStyle:{width:"50px",height:"50px"},attrs:{src:s.icon}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon",staticStyle:{width:"50px",height:"50px","line-height":"50px"}}),t("el-input",{staticStyle:{display:"none"},model:{value:s.icon,callback:function(t){e.$set(s,"icon",t)},expression:"item.icon"}})],1),t("el-input",{staticClass:"mr-10",staticStyle:{width:"120px"},model:{value:s.name,callback:function(t){e.$set(s,"name",t)},expression:"item.name"}}),t("el-select",{staticClass:"mr-10",staticStyle:{width:"120px"},attrs:{placeholder:"请选择应用类型"},model:{value:s.type,callback:function(t){e.$set(s,"type",t)},expression:"item.type"}},[t("el-option",{attrs:{label:"应用内",value:"1"}}),t("el-option",{attrs:{label:"外部URL",value:"2"}})],1),t("el-input",{staticClass:"mr-10",staticStyle:{width:"300px"},model:{value:s.url,callback:function(t){e.$set(s,"url",t)},expression:"item.url"}}),t("el-input",{staticClass:"mr-10",staticStyle:{width:"80px"},model:{value:s.order,callback:function(t){e.$set(s,"order",t)},expression:"item.order"}}),t("el-switch",{staticStyle:{width:"60px"},attrs:{"active-value":"1","inactive-value":"0"},model:{value:s.status,callback:function(t){e.$set(s,"status",t)},expression:"item.status"}}),t("el-button",{attrs:{type:"danger",icon:"el-icon-minus",circle:""},on:{click:function(t){return e.delAppItem(s)}}})],1)])})),t("el-form-item",[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.addAppItem}},[e._v("添加应用")])],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("compass")}}},[e._v("保存")])],1)],2)],1)],1)],1)},l=[],i=(s(7658),s(4462)),o=s.n(i),r=s(8867),n=s.n(r),c=s(6647),p={components:{VueQr:n(),userSelect:c.Z},data(){return{loadding:!1,sysInfo:{name:"",description:"",logo:"",regtype:"1",registerInterval:0,regauth:"2",ipregion:"1",runMode:"1",diyName:"0",state:!0,closeTips:"",multipleLogin:"0"},chatInfo:{simpleChat:!0,groupChat:!0,groupUserMax:0,online:!0,msgClear:!0,msgClearDay:0,webrtc:!0,stun:"",stunUser:"",stunPass:"",sendInterval:"",redoTime:120,dbDelMsg:!1,autoAddGroup:{status:0,userMax:"",owner_uid:"",owner_info:[],name:""},autoAddUser:{status:0,user_ids:[],user_items:[]}},smtp:{host:"",port:465,security:"ssl",addr:"",pass:"",sign:""},compass:{status:"1",mode:"1",list:[]},fileUpload:{disk:"local",aliyun:{accessId:"",accessSecret:"",endpoint:"",bucket:"",url:""},qiniu:{accessKey:"",secretKey:"",bucket:"",url:""},qcloud:{appId:"",secretId:"",secretKey:"",region:"",bucket:"",cdn:""},preview:"",size:0,fileExt:""},options:["jpg","png"],inviteUrl:"",textEmail:"",rules:{name:[{required:!0,message:"请输入系统名称",trigger:"blur"},{min:2,max:32,message:"长度在 2 到 32 个字符",trigger:"blur"}],description:[{required:!0,message:"请输入系统描述",trigger:"blur"}]},chatRules:{groupUserMax:[{required:!0,message:"请输入群组人数上限",trigger:"blur"}],msgClearDay:[{required:!0,message:"请输入消息保存天数",trigger:"blur"}]},smtpRules:{host:[{required:!0,pattern:"^[a-z0-9]+([-.]{1}[a-z0-9]+)*.[a-z]{2,5}$",message:"请输入SMTP服务器地址",trigger:"blur"}],port:[{required:!0,type:"number",message:"请输入SMTP服务器端口",trigger:"blur"}],addr:[{required:!0,type:"email",message:"请输入SMTP邮箱",trigger:["blur","change"]}],pass:[{required:!0,message:"请输入SMTP邮箱密码",trigger:"blur"}]},fileRules:{size:[{required:!0,type:"number",message:"请输入文件大小限制",trigger:"blur"}],fileExt:[{required:!0,message:"请输入文件格式限制",trigger:"blur"}]},compassRules:{compassMode:[{required:!0,message:"请选择展示模式",trigger:"blur"}]}}},computed:{getToken(){const e=o().get("authToken");return{Authorization:e}},getUrl(){return window.BASE_URL+"/common/upload/uploadImage"}},mounted(){this.initConfig(),this.resetInviteUrl()},methods:{initConfig(){this.$api.configApi.getAllConfig({}).then((e=>{0==e.code&&e.data.forEach((e=>{switch(e.name){case"sysInfo":e.value&&(this.sysInfo=Object.assign(this.sysInfo,e.value));break;case"chatInfo":e.value&&(this.chatInfo=Object.assign(this.chatInfo,e.value));break;case"smtp":e.value&&(this.smtp=Object.assign(this.smtp,e.value));break;case"fileUpload":e.value&&(this.fileUpload=Object.assign(this.fileUpload,e.value));break;case"compass":e.value&&(this.compass=Object.assign(this.compass,e.value));break}}))}))},submitForm(e){this.$refs[e].validate((t=>{if(!t)return console.log("error submit!!"),!1;var s={};switch(s.name=e,e){case"sysInfo":s.value=this.sysInfo;break;case"chatInfo":s.value=this.chatInfo;break;case"smtp":s.value=this.smtp;break;case"fileUpload":s.value=this.fileUpload;break;case"compass":let e=this.compass,t=e.list.filter((e=>""!=e.name&&""!=e.icon&&""!=e.url));e.list=t,s.value=e;break}this.$api.configApi.setConfig(s).then((e=>{0==e.code&&this.$message({message:e.msg,type:"success"})}))}))},resetForm(e){this.$refs[e].resetFields()},uploadSuccess(e,t){this.sysInfo.logo=e.data},iconUploadSuccess(e,t,s){this.compass.list[e].icon=t.data},beforeAvatarUpload(e){},change(e,t){},copyUrl(){this.$clipboard(this.inviteUrl),this.$message({message:"复制成功",type:"success"})},resetInviteUrl(){this.$api.configApi.getInviteLink({}).then((e=>{0==e.code&&(this.inviteUrl=e.data)}))},sendEmail(){this.textEmail?(this.loadding=!0,this.$confirm("确定发送测试邮件吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$api.configApi.sendTestEmail({email:this.textEmail}).then((e=>{this.loadding=!1,this.textEmail="",0==e.code&&this.$message({message:e.msg,type:"success"})}))})).catch((()=>{this.loadding=!1}))):this.$message({message:"请输入邮箱地址",type:"warning"})},addAppItem(){let e=this.compass.list;e.push({id:1,url:"",icon:"",name:"",type:"2",badge:0,order:0,status:"1"}),this.compass.list=e},delAppItem(e){var t=this.compass.list.indexOf(e);-1!==t&&this.compass.list.splice(t,1)},changeUser(e,t){this.chatInfo.autoAddUser.user_ids=e,this.chatInfo.autoAddUser.user_items=t},changeOwner(e,t){this.chatInfo.autoAddGroup.owner_uid=e,this.chatInfo.autoAddGroup.owner_info=t}}},u=p,d=s(1001),m=(0,d.Z)(u,a,l,!1,null,"5a260d74",null),f=m.exports}}]);